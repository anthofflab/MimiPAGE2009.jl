<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Technical User Guide · MimiPAGE2009.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MimiPAGE2009.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../gettingstarted/">Getting started</a></li><li><a class="tocitem" href="../model-structure/">Model Structure</a></li><li class="is-active"><a class="tocitem" href>Technical User Guide</a><ul class="internal"><li><a class="tocitem" href="#Folder-Structure-1"><span>Folder Structure</span></a></li><li><a class="tocitem" href="#Code-format-1"><span>Code format</span></a></li></ul></li><li><a class="tocitem" href="../validation/">Model Validation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Technical User Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Technical User Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/anthofflab/MimiPAGE2009.jl/blob/master/docs/src/technicaluserguide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Technical-User-Guide-1"><a class="docs-heading-anchor" href="#Technical-User-Guide-1">Technical User Guide</a><a class="docs-heading-anchor-permalink" href="#Technical-User-Guide-1" title="Permalink"></a></h1><h2 id="Folder-Structure-1"><a class="docs-heading-anchor" href="#Folder-Structure-1">Folder Structure</a><a class="docs-heading-anchor-permalink" href="#Folder-Structure-1" title="Permalink"></a></h2><p>The folders are organized as follows.</p><p><strong>src/components</strong></p><p>Here you will find the model components, i.e. the code.</p><p><strong>src/utils</strong></p><p>This folder has a number of lower level helper routines for loading data and running Monte Carlo simulations.</p><p><strong>src</strong></p><p>This folder has the main model composition and run code.</p><p><strong>data</strong></p><p>Here you will find data that are utilized by the components. This includes initial values, input parameters, and socioeconomic scenarios. The data we used to calibrate our model comes from the PAGE09 Excel version, generously provided by Chris Hope.</p><p><strong>docs</strong></p><p>The documentation is stored here, including the the index, getting started, scientific guide, and this file.</p><p><strong>test</strong></p><p>This folder contains files that were and still can be used to make sure a component is fully functional. The tests run each individual component separately so you can diagnose which might not be working and why. (They should all work). The tests take inputs, normally provided by other components, and produce outputs that often would otherwise go to other components. Both are stored in <code>test/validationdata</code>. There is also test for the entire model in &quot;test_mainmodel.jl&quot;</p><p><strong>data/policy-b</strong> and <strong>test/validationdata/policy-b</strong></p><p>PAGE &#39;09 provides a low emissions policy scenario.  The input data for that scenario is provided in <code>data/policy-b</code> and validation data in <code>test/validationdata/policy-b</code>.  See <code>test/test_mainmodel_policyb/jl</code> for an example of its usage.  The code is designed so that other policies can be added in the same fashion.</p><h2 id="Code-format-1"><a class="docs-heading-anchor" href="#Code-format-1">Code format</a><a class="docs-heading-anchor-permalink" href="#Code-format-1" title="Permalink"></a></h2><ul><li>The code is written in Julia (v1.0 or greater).</li><li>The data are in CSV format for easy portability and manipulation.</li><li>The docs are in Markdown format for readability on github.</li></ul><p>Each component in the model (and the test files as well) has the same basic Mimi structure.</p><p>Here we show the code for the CO2 Forcing component to provide an example of the Mimi structure with comments.</p><pre><code class="language-none"># Imports the Mimi package. This is only done with certain components,
# because once it is loaded in the model, it becomes redundant code.
using Mimi</code></pre><p>Now we will define the component with its parameters (inputs) and variables (outputs).</p><pre><code class="language-none">@defcomp co2forcing begin 
    # this defines the component, gives it a name, and starts the code chunk
    # We can set default parameter values here or elsewhere in the code either 
    # as a external value or the output of a variable in another component

    c_CO2concentration=Parameter(index=[time],unit=&quot;ppbv&quot;)
    f0_CO2baseforcing=Parameter(unit=&quot;W/m2&quot;, default=1.735)
    fslope_CO2forcingslope=Parameter(unit=&quot;W/m2&quot;, default=5.5)
    c0_baseCO2conc=Parameter(unit=&quot;ppbv&quot;, default=395000.)
    f_CO2forcing=Variable(index=[time],unit=&quot;W/m2&quot;)
end</code></pre><p>Next we will create the function that carries the components equations. These equations utilize the parameters and variables defined above.  This function is contained within the <code>@defcomp</code> macro.</p><pre><code class="language-none">function run_timestep(p, v, d, t)

    #eq.13 in Hope 2006
    v.f_CO2forcing[t]=p.f0_CO2baseforcing+p.fslope_CO2forcingslope*log(p.c_CO2concentration[t]/p.c0_baseCO2conc)
end</code></pre><p>In some cases we also define a function that is used to add the component to the main model where we can set exogenous parameters imported from a CSV file.  In this case such a step is not needed.</p><p>In the <code>src/MimiPAGE2009.jl</code> file, you will find code that sends variables between components. For example,</p><pre><code class="language-none">CO2forcing[:c_CO2concentration] = CO2cycle[:c_CO2concentration] # incoming = outgoing.
# In this case, the `c_CO2concentration` is constructed in the `CO2cycle` component
# and then sent to the `CO2forcing` component.</code></pre><p>Once the model has run, you can access variable outputs with this syntax (note, that the model is referred to as <code>m</code>):</p><pre><code class="language-none">m[:co2forcing, :f_CO2forcing]</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model-structure/">« Model Structure</a><a class="docs-footer-nextpage" href="../validation/">Model Validation »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 26 August 2022 05:10">Friday 26 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
